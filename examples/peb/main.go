package main

import (
	"encoding/hex"
	"fmt"
	"github.com/osonkr/malware-development/win32"
)

func xor(s string) string {
	n := make([]byte, len(s))
	for i := range s {
		n[i] = s[i] ^ 0xc
	}
	return string(n)
}

func main() {
	dll, _ := hex.DecodeString("67697e6269603f3e22686060")

	handle := win32.GetModuleHandle(string(dll), xor)

	fmt.Printf("%x\n", handle)

	//header := (*win32.IMAGE_DOS_HEADER)(unsafe.Pointer(handle))
	//fmt.Println(handle + header.Elfanew)
}
